<!DOCTYPE html>
<html class="dark" lang="en">
<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Driver State Monitoring - Herry</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&amp;display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <link rel="stylesheet" type="text/css" href="css/global.css" />
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#FFFFFF",
              "background-light": "#F0F2F5",
              "background-dark": "#0A0A0A",
              "content-light": "#1C1C1E",
              "content-dark": "#E5E5E7",
              "subtle-light": "#636366",
              "subtle-dark": "#8E8E93",
              "border-light": "#D1D1D6",
              "border-dark": "#2A2A2C",
            },
            fontFamily: {
              display: ["Space Grotesk", "sans-serif"],
            },
            animation: {
              fadeInUp: 'fadeInUp 0.8s ease-out forwards'
            },
            keyframes: {
              fadeInUp: {
                '0%': { opacity: '0', transform: 'translateY(20px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' },
              }
            }
          },
        },
      };
    </script>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-content-light dark:text-content-dark transition-colors duration-300">
    <div class="sphere-container">
      <div class="sphere sphere-1"></div>
      <div class="sphere sphere-2"></div>
      <div class="sphere sphere-3"></div>
    </div>
    
    <header class="fixed top-0 left-0 w-full z-50 py-8 px-6 md:px-12 animate-fadeInUp">
        <nav class="flex justify-between items-center w-full">
            <div class="flex items-center">
                <button id="mobile-menu-btn" class="md:hidden text-content-light dark:text-content-dark focus:outline-none mr-4">
                    <span class="material-icons-outlined text-3xl">menu</span>
                </button>
                <div class="hidden md:flex items-center space-x-8 text-sm text-subtle-light dark:text-subtle-dark">
                    <a class="hover:text-content-light dark:hover:text-content-dark transition-colors duration-200" href="about.html">about</a>
                    <a class="text-content-light dark:text-content-dark font-medium" href="projects.html">projects</a>
                    <a class="hover:text-content-light dark:hover:text-content-dark transition-colors duration-200" href="blog.html">blog</a>
                    <a class="hover:text-content-light dark:hover:text-content-dark transition-colors duration-200" href="contact.html">contact</a>
                </div>
            </div>
            <a class="text-xl font-bold text-content-light dark:text-content-dark tracking-tight" href="index.html">Herry</a>
        </nav>
        <div id="mobile-menu" class="hidden absolute top-full left-0 w-full mt-2 px-6 pb-6 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-xl border-b border-border-light dark:border-border-dark shadow-2xl flex-col space-y-4 md:hidden">
            <a class="text-lg font-medium text-content-light dark:text-content-dark block py-2 border-b border-border-light dark:border-border-dark" href="about.html">about</a>
            <a class="text-lg font-medium text-content-light dark:text-content-dark block py-2 border-b border-border-light dark:border-border-dark" href="projects.html">projects</a>
            <a class="text-lg font-medium text-content-light dark:text-content-dark block py-2 border-b border-border-light dark:border-border-dark" href="blog.html">blog</a>
            <a class="text-lg font-medium text-content-light dark:text-content-dark block py-2" href="contact.html">contact</a>
        </div>
    </header>

    <div class="relative min-h-screen flex flex-col items-center px-4 sm:px-6 lg:px-8 overflow-hidden pt-32">
        <div class="relative z-10 w-full max-w-3xl mx-auto pb-20 md:pb-32">
            <main>
              
              <div class="animate-fadeInUp mb-8" style="animation-delay: 150ms;">
                <a href="projects.html" class="text-sm text-subtle-light dark:text-subtle-dark hover:text-content-light dark:hover:text-content-dark transition-colors flex items-center">
                    <span class="material-icons-outlined text-sm mr-1">arrow_back</span> Back to Projects
                </a>
              </div>

              <div class="animate-fadeInUp mb-10 pb-8 border-b border-border-light dark:border-border-dark" style="animation-delay: 200ms;">
                <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-6">
                    <div>
                        <h1 class="text-4xl md:text-5xl font-bold tracking-tighter text-content-light dark:text-content-dark mb-4 leading-tight">
                            Edge-Optimized Driver State Monitoring
                        </h1>
                        <p class="text-lg text-subtle-light dark:text-subtle-dark">
                            Real-time computer vision on CPU-only edge devices
                        </p>
                    </div>
                    
                    <a href="https://github.com/herry73/realtime-driver-state-monitoring" target="_blank" class="inline-flex items-center px-6 py-3 bg-content-light dark:bg-content-dark text-background-light dark:text-background-dark font-bold rounded-lg hover:opacity-90 transition-opacity">
                        <span class="material-icons-outlined text-lg mr-2">code</span>
                        View Code
                    </a>
                </div>
              </div>

              <article class="prose prose-lg dark:prose-invert prose-headings:font-display prose-a:text-blue-500 hover:prose-a:text-blue-400 max-w-none animate-fadeInUp" style="animation-delay: 300ms;">
                
                <h2>Overview</h2>
                <p>
                    This project explores how to deploy a modern deep learning vision model under real-world edge constraints. I built a real-time system to detect driver drowsiness and distraction (e.g. texting, drinking, reaching behind) while optimizing the model to run efficiently on CPU-only hardware with limited memory.
                </p>
                <p>
                    Rather than focusing purely on accuracy, the core challenge was model efficiency, stability, and deployability.
                </p>

                <h2>Problem</h2>
                <p>
                    Most deep learning models assume access to GPUs and abundant memory. In contrast, automotive and IoT deployments often operate with:
                </p>
                <ul>
                    <li>No GPU acceleration</li>
                    <li>Tight memory budgets</li>
                    <li>Strict latency requirements</li>
                </ul>
                <p>
                    The baseline model achieved strong accuracy but was too large and inefficient for edge deployment. The goal was to retain model fidelity while significantly reducing model size and improving CPU inference performance.
                </p>

                <h2>Model & Dataset</h2>
                <ul>
                    <li><strong>Backbone:</strong> MobileNetV3-Large</li>
                    <li><strong>Classes:</strong> 10 driver behaviors (safe driving, texting, phone usage, drinking, etc.)</li>
                    <li><strong>Input:</strong> 224×224 RGB images normalized with ImageNet statistics</li>
                </ul>
                <p>
                    Initial experiments used MobileNetV3-Small, but it struggled with fine-grained distraction classes. MobileNetV3-Large provided stronger feature representation, making it a better candidate for post-training optimization.
                </p>

                <h2>Optimization: Post-Training Static Quantization</h2>
                <p>
                    To enable edge deployment, I applied Post-Training Static Quantization (INT8) in PyTorch. I chose static quantization because vision models are dominated by activation memory, and dynamic quantization alone is often insufficient.
                </p>
                <h3>Pipeline</h3>
                <ol>
                    <li><strong>Layer Fusion:</strong> Fused (Conv–BatchNorm–Activation) layers to reduce memory access overhead.</li>
                    <li><strong>Instrumentation:</strong> Inserted QuantStub/DeQuantStub.</li>
                    <li><strong>Calibration:</strong> Calibrated with real validation data to estimate activation ranges.</li>
                    <li><strong>Conversion:</strong> Converted to a fully INT8 model using PyTorch’s FBGEMM backend.</li>
                </ol>

                <h2>Results</h2>
                <div class="overflow-x-auto my-8">
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="border-b border-border-light dark:border-border-dark text-subtle-light dark:text-subtle-dark">
                                <th class="py-2">Metric</th>
                                <th class="py-2">Float32</th>
                                <th class="py-2">INT8 (Quantized)</th>
                            </tr>
                        </thead>
                        <tbody class="text-content-light dark:text-content-dark">
                            <tr class="border-b border-border-light dark:border-border-dark">
                                <td class="py-2 font-medium">Model Size</td>
                                <td class="py-2">16.2 MB</td>
                                <td class="py-2 font-bold text-green-500">4.49 MB</td>
                            </tr>
                            <tr class="border-b border-border-light dark:border-border-dark">
                                <td class="py-2 font-medium">Compression</td>
                                <td class="py-2">—</td>
                                <td class="py-2">3.6× smaller</td>
                            </tr>
                            <tr class="border-b border-border-light dark:border-border-dark">
                                <td class="py-2 font-medium">Accuracy Loss</td>
                                <td class="py-2">—</td>
                                <td class="py-2">&lt; 0.5%</td>
                            </tr>
                            <tr>
                                <td class="py-2 font-medium">Hardware</td>
                                <td class="py-2">GPU / Server</td>
                                <td class="py-2">CPU-only edge</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h2>Real-Time Inference</h2>
                <p>
                    I built a real-time inference pipeline to validate deployment readiness. The system performs webcam capture at >30 FPS, handles preprocessing on the CPU, and executes fully quantized INT8 inference. The result is a system that runs smoothly on standard x86 CPUs without any GPU acceleration.
                </p>

                <h2>Key Learnings</h2>
                <ul>
                    <li>High-accuracy models can be made edge-deployable without retraining.</li>
                    <li>Quantization is a systems problem, not just a modeling trick.</li>
                    <li>Calibration quality is critical to preserving accuracy.</li>
                    <li>Architectural choices strongly influence quantization robustness.</li>
                </ul>

                <h2>Future Work</h2>
                <ul>
                    <li>Quantization-Aware Training (QAT) to recover that last 0.5% accuracy.</li>
                    <li>ONNX export for C++ deployment.</li>
                    <li>Testing on ARM-based edge platforms (Raspberry Pi, Jetson Nano).</li>
                </ul>

              </article>

            </main>
            
            <footer class="w-full py-12 text-center mt-12 border-t border-border-light dark:border-border-dark animate-fadeInUp">
              <p class="text-sm text-subtle-light dark:text-subtle-dark">All rights reserved.</p>
            </footer>
        </div>
    </div>
    
    <script>
        const menuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        if (menuBtn && mobileMenu) {
            menuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
                mobileMenu.classList.toggle('flex');
            });
        }
    </script>
</body>
</html>